Web3 Study Log 004

2025-7-6

ä»Šå¤©åšå®Œäº†æ˜¨å¤©è¯´çš„é‚£ä¸ªç»ƒä¹ ï¼Œæœ‰ç‚¹éš¾åº¦ï¼Œä½†æ˜¯è¿˜å¥½ã€‚ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œå¤–é¢æ™´ç©ºä¸‡é‡Œï¼Œçª—å¤–è“å¤©ç™½äº‘ï¼Œå†æ³¡æ¯èŒ¶ï¼Œæ”¾ç‚¹éŸ³ä¹ï¼Œååœ¨æ¡Œå‰å†™ä»£ç ï¼Œå¾ˆèˆ’æœï¼Œå¹³é™çš„ç”Ÿæ´»ã€‚ä¸‹åˆå‡ºå»é”»ç‚¼äº†ä¸€ä¼šï¼Œå›æ¥ä¸æƒ³å­¦ä¹ ï¼Œä¹Ÿä¸çŸ¥é“å¹²å˜›ï¼Œæ‰å‘ç°è‡ªå·±çš„ç¤¾äº¤åœˆå¾ˆçª„ï¼Œæˆ‘æ˜¯å¾ˆä¹ æƒ¯ä¸€ä¸ªäººçš„ç”Ÿæ´»ï¼Œç¤¾äº¤æ¯”è¾ƒç´¯ï¼Œæ¶ˆè€—èƒ½é‡ï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œå¯èƒ½æ¯ä¸¤ä¸‰ä¸ªæœˆå°±å¾ˆæƒ³å’Œæœ‹å‹ä¸€èµ·å‡ºå»çˆ†ç©ä¸€ä¸‹ï¼Œä½†æ˜¯éƒ½æ˜¯ä¸´æ—¶èµ·æ„ï¼Œä¸€èˆ¬éƒ½çº¦ä¸æˆï¼Œå¤§å®¶éƒ½æœ‰è‡ªå·±çš„å®‰æ’ï¼Œå“... å¸Œæœ›èƒ½è®¤è¯†äº›æ–°çš„æœ‹å‹ï¼Œå‡†å¤‡åƒæ™šé¥­äº†ï¼Œæ™šä¸Šä¸€ä¸ªäººå»æ´ªå´–æ´é€›é€›ï¼Œæ•£æ•£æ­¥ï¼Œæ„Ÿå—ä¸‹äººæ°”ï¼Œç”Ÿæ´»å°±æ˜¯è¿™ä¹ˆå¹³æ·¡

O_Oï¼Œå¯¹äº†ï¼Œå¸Œæœ›åˆ·åˆ°çš„æœ‹å‹ï¼Œæƒ³å­¦ä¹ æ™ºèƒ½åˆçº¦å¼€å‘çš„æœ‹å‹å¯ä»¥staræˆ‘çš„ä»“åº“å•Šï¼šhttps://github.com/JNHFlow21/solidity-learningï¼Œæˆ‘ä¼šä¸€ç›´æŒç»­æ›´æ–°çš„ï¼Œé‡Œé¢æœ‰æˆ‘è‡ªå·±æ•´ç†ä½¿ç”¨çš„æ™ºèƒ½åˆçº¦å¼€å‘çš„èµ„æ–™ã€‚

**Web3 Study Log 003**

**2025-07-06**

finished the practice exercise i mentioned yesterday

a bit tricky but managed to get through it

the weather today was amazing â€” clear blue skies and bright sun

brewed some tea, put on some music, and sat down to code

simple moments like that feel peaceful

this is the kind of life i enjoy

went out for a quick workout in the afternoon

came back and didnâ€™t really feel like studying

wasnâ€™t sure what to do honestly

kinda realized how small my social circle is

iâ€™m pretty used to being on my own â€” socializing drains energy

but every couple months, i get this sudden urge to hang out and go wild with friends

thing isâ€¦ itâ€™s always spontaneous

so most of the time it doesnâ€™t happen â€” everyoneâ€™s got their own life

ah wellâ€¦ would be nice to meet some new people

anyway, about to go grab dinner

thinking of walking around Hongyadong alone tonight

just to soak in the city energy a bit

nothing fancy â€” just regular quiet life

------

# **ğŸ“˜ DeFi é¡¹ç›®å®æˆ˜ç»ƒä¹ ç¬”è®°ï¼šToken Presale with Linear Vesting**

## **ğŸª™ ç»ƒä¹ èƒŒæ™¯è¯´æ˜**

åœ¨ DeFi é¡¹ç›®ä¸­ï¼Œæ–°ä»£å¸ä¸Šçº¿å‰é€šå¸¸ä¼šå¼€å±•é¢„å”®ä»¥ç­¹é›†å¯åŠ¨èµ„é‡‘ã€‚æœ¬ç»ƒä¹ æ¨¡æ‹Ÿä¸€ä¸ªå…¸å‹çš„ Token é¢„å”®åœºæ™¯ï¼Œç›®æ ‡æ˜¯è®¾è®¡ä¸€ä¸ª**æ”¯æŒ ETH æèµ ã€Chainlink æ±‡ç‡è½¬æ¢ã€çº¿æ€§é‡Šæ”¾ä»£å¸**çš„æ™ºèƒ½åˆçº¦ TokenPresaleã€‚

------

## **ğŸ“‹ åŠŸèƒ½éœ€æ±‚æ–‡æ¡£ï¼ˆé¢˜ç›®è¦æ±‚ï¼‰**

### **âœ… åœºæ™¯è®¾å®š**

- é¡¹ç›®æ–¹è®¾ç½®ä¸€ä¸ª USD å‹Ÿé›†ç›®æ ‡ï¼ˆå¦‚ 5000 USDï¼‰ã€‚
- æŠ•èµ„äººé€šè¿‡ ETH å‚ä¸é¢„å”®ã€‚
- ä½¿ç”¨ Chainlink ETH/USD é¢„è¨€æœºè¿›è¡Œæ±‡ç‡è½¬æ¢ã€‚
- è®¾ç½®é¢„å”®ç»“æŸæ—¶é—´ã€‚
- è®¾ç½®çº¿æ€§è§£é”è§„åˆ™ï¼ˆå¦‚ 180 å¤©å†…é€æ­¥é‡Šæ”¾ Tokenï¼‰ã€‚
- é¡¹ç›®æ–¹æç°åï¼Œç”¨æˆ·æ ¹æ®è´¡çŒ®é¢†å– Tokenï¼Œä¸èƒ½é€€æ¬¾ã€‚

------

### **âœ… çŠ¶æ€å˜é‡è®¾è®¡**

| **å˜é‡å**         | **è¯´æ˜**                                       |
| ------------------ | ---------------------------------------------- |
| owner              | é¡¹ç›®æ–¹åœ°å€                                     |
| presaleEndTime     | é¢„å”®ç»“æŸæ—¶é—´æˆ³                                 |
| goalInUsd          | å‹Ÿé›†ç›®æ ‡ï¼ˆUSDï¼‰                                |
| tokenPerUsdRate    | 1 USD å¯å…‘æ¢å¤šå°‘ Tokenï¼ˆå¦‚ 1 USD = 100 Tokenï¼‰ |
| totalUsdRaised     | å½“å‰å·²å‹Ÿèµ„æ€»é¢ï¼ˆUSDï¼‰                          |
| unlockStartTime    | è§£é”èµ·å§‹æ—¶é—´ï¼ˆæç°åè®¾ç½®ï¼‰                     |
| unlockDuration     | è§£é”æ€»æ—¶é•¿ï¼ˆå¦‚ 180 å¤©ï¼Œç»ƒä¹ ä¸­è®¾ç½®ä¸º 1 å¤©ï¼‰     |
| isClaimEnabled     | æ˜¯å¦å…è®¸ç”¨æˆ·é¢†å– Token                         |
| userUsdContributed | æ¯ä¸ªç”¨æˆ·è´¡çŒ®çš„ USD é‡‘é¢ï¼ˆå•ä½ï¼š1e18ï¼‰          |
| userTotalToken     | æ¯ä¸ªç”¨æˆ·åº”å¾—çš„ Token æ•°é‡                      |
| userClaimedTokens  | æ¯ä¸ªç”¨æˆ·å·²é¢†å–çš„ Token æ•°é‡                    |
| contributors       | æ‰€æœ‰å‚ä¸è¿‡æèµ çš„åœ°å€                           |
| paused             | ç´§æ€¥æš‚åœå¼€å…³                                   |

------

### **âœ… å‡½æ•°éœ€æ±‚**

| **å‡½æ•°å**          | **åŠŸèƒ½è¯´æ˜**                                      |
| ------------------- | ------------------------------------------------- |
| fund()              | æ¥æ”¶ ETH å¹¶è®°å½•æèµ ï¼›æ£€æŸ¥æ—¶é—´ã€æ±‡ç‡è½¬æ¢ã€æœ€å°é‡‘é¢ |
| withdrawETH()       | é¡¹ç›®æ–¹æç° ETHï¼Œè§¦å‘è§£é”é€»è¾‘                      |
| enableClaim()       | å†…éƒ¨å‡½æ•°ï¼Œè®¾ç½® unlockStartTimeï¼Œåˆå§‹åŒ–è§£é”å‚æ•°    |
| claimTokens()       | ç”¨æˆ·æŒ‰æ¯”ä¾‹é¢†å–è§£é”çš„ Token                        |
| getTokenClaimable() | æŸ¥çœ‹å½“å‰å¯é¢†å–çš„ Token æ•°é‡                       |
| getUserInfo()       | è¿”å›æŸåœ°å€çš„æ€»æã€å·²é¢†å–ã€å¯é¢†å– Token            |
| pause() / unpause() | é¡¹ç›®æš‚åœä¸æ¢å¤                                    |

------

### **âœ… ä½¿ç”¨çš„çŸ¥è¯†ç‚¹**

- modifier onlyOwner, canWithdraw, canClaim, notPaused
- Chainlink é¢„è¨€æœºï¼ˆETH/USDï¼‰
- ç²¾åº¦æ§åˆ¶ï¼ˆ1e18 å•ä½ï¼‰
- receive() å’Œ fallback() ç”¨äºè‡ªåŠ¨æ¥æ”¶ ETH
- è§£é”æ¯”ç‡ = (å½“å‰æ—¶é—´ - è§£é”èµ·å§‹æ—¶é—´) / æ€»è§£é”æ—¶é—´
- call è½¬è´¦æ–¹å¼
- è‡ªå®šä¹‰é”™è¯¯ï¼ˆå¦‚ PresaleEnded, GoalReached, TooSmallï¼‰

------

## **ğŸ§  å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ä¸è§£ç­”**

### **â“ Q1: Remix éƒ¨ç½²æ—¶æ˜¯å¦éœ€è¦å•ç‹¬éƒ¨ç½²** PriceConverterï¼Ÿ

**ç­”**ï¼šä¸éœ€è¦ã€‚PriceConverter æ˜¯ libraryï¼Œä½ å¯¼å…¥å¹¶ä½¿ç”¨äº†å…¶ä¸­çš„å‡½æ•°ï¼ˆä¾‹å¦‚ getLatestETHPriceInUSDï¼‰ã€‚åªéœ€è¦éƒ¨ç½²ä¸»åˆçº¦ TokenPresaleï¼ŒRemix ä¼šè‡ªåŠ¨é“¾æ¥ä¾èµ–ã€‚

------

### **â“ Q2: Chainlink è¿”å›çš„æ±‡ç‡ç²¾åº¦æ˜¯å¤šå°‘ï¼Ÿ**

**ç­”**ï¼šä½ ä½¿ç”¨çš„ Aggregator åœ°å€è¿”å›çš„æ˜¯ 8 ä½å°æ•°çš„ä»·æ ¼ï¼ˆå¦‚ 1850.12345678ï¼‰ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸º 18 ä½ç²¾åº¦ï¼š

```
uint256 ethPrice = uint256(answer * 1e10);
```

æœ€ç»ˆ USD = ethPrice * msg.value / 1e18ï¼Œå•ä½æ˜¯ 1e18 ç²¾åº¦ã€‚

------

### **â“ Q3: ä»€ä¹ˆæ˜¯çº¿æ€§è§£é”ï¼Ÿèµ·å§‹æ—¶é—´å’Œæ€»æ—¶é•¿å¦‚ä½•è®¾ç½®ï¼Ÿ**

**ç­”**ï¼š

- **çº¿æ€§è§£é”**ï¼šToken ä¸æ˜¯ä¸€æ¬¡æ€§é¢†å–ï¼Œè€Œæ˜¯æ ¹æ®æ—¶é—´æ¯”ä¾‹é€æ­¥è§£é”ï¼ˆå¦‚æ¯å¤©è§£é” 1/180ï¼‰ã€‚
- **èµ·å§‹æ—¶é—´**ï¼šé€šå¸¸æ˜¯é¡¹ç›®æ–¹æç°ä¹‹åï¼Œå³ TGEï¼ˆToken Generation Eventï¼‰å¼€å§‹ã€‚
- **æ€»æ—¶é•¿**ï¼šæ˜¯ä» unlockStartTime å¼€å§‹ï¼Œåˆ° unlockStartTime + unlockDuration ç»“æŸã€‚

```
unlockStartTime = block.timestamp; // enableClaim() è§¦å‘æ—¶è®¾ç½®
unlockDuration = 1 days; // æ¨¡æ‹Ÿç»ƒä¹ 
```

------

## **ğŸ› ï¸ æˆ‘çš„æœ€ç»ˆåˆçº¦è®¾è®¡äº®ç‚¹**

- âœ… ä½¿ç”¨ Chainlink è·å– ETH/USD å®æ—¶æ±‡ç‡
- âœ… é™åˆ¶æœ€ä½æèµ é‡‘é¢ 10 USD
- âœ… è‡ªåŠ¨åˆ¤æ–­æ—¶é—´ä¸ç›®æ ‡è¾¾æˆ
- âœ… withdraw åç«‹å³ enableClaim å¹¶åˆå§‹åŒ–è§£é”
- âœ… ç”¨æˆ·é€šè¿‡ claimTokens æŒ‰æ¯”ä¾‹é¢†å– Token
- âœ… ä½¿ç”¨ modifier é™åˆ¶éæ³•æ“ä½œ
- âœ… å®ç° pause/unpause
- âœ… æä¾› getUserInfo ä¸€é”®æŸ¥çœ‹ç”¨æˆ·çŠ¶æ€

------

## **âœ… ç¤ºä¾‹ä»£ç ç‰‡æ®µï¼šclaimTokens**

```
function claimTokens() public canClaim {
    uint256 claimable = getTokenClaimable(msg.sender);
    userClaimedTokens[msg.sender] += claimable;

    // æ¨¡æ‹Ÿè½¬è´¦ï¼ˆå¦‚æœ‰ Token åˆçº¦åº”è°ƒç”¨ transferï¼‰
    // IERC20(tokenAddress).transfer(msg.sender, claimable);
}
```

------

## **ğŸ”— æœ¬ç»ƒä¹ å…³è”ä»“åº“ç»“æ„è¯´æ˜**

ä»“åº“åœ°å€ï¼šhttps://github.com/JNHFlow21/solidity-learning

| **æ–‡ä»¶å¤¹å**    | **è¯´æ˜**           |
| --------------- | ------------------ |
| remix-section-2 | section2 ç»ƒä¹       |
| section-1       | åŸºç¡€éƒ¨åˆ†           |
| remix-fundme    | é¡¹ç›® FundMe å®æˆ˜   |
| DeFi é¢„å”®åˆçº¦   | æœ¬ç»ƒä¹ çš„å®Œæ•´å®ç°   |
| artifacts       | Remix ç¼–è¯‘äº§ç‰©     |
| README.md       | å­¦ä¹ æµç¨‹æ€»è¯´æ˜æ–‡æ¡£ |

------

## **ğŸ“Œ æ€»ç»“**

é€šè¿‡æœ¬ç»ƒä¹ ï¼Œä½ æŒæ¡äº†ï¼š

- Solidity åˆçº¦å¼€å‘ä¸­çš„å…¸å‹ DeFi åœºæ™¯
- æ±‡ç‡è½¬æ¢ã€çº¿æ€§è§£é”ã€é¡¹ç›®æ–¹æç°ã€æèµ æ˜ å°„ç­‰å…¸å‹åˆçº¦é€»è¾‘
- modifier ä¸è‡ªå®šä¹‰é”™è¯¯æœºåˆ¶çš„ç»“åˆä½¿ç”¨
- å¤š mapping çš„ç»¼åˆçŠ¶æ€ç®¡ç†
- åˆçº¦ç»“æ„ä¸ä»£ç ç»„ç»‡æ€è·¯

ç»ƒä¹ å¸®åŠ©ä½ èµ°å‡ºç®€å•å‡½æ•°è°ƒç”¨çš„é˜¶æ®µï¼Œå¼€å§‹çœŸæ­£æ„å»ºå…·æœ‰å®Œæ•´ç”Ÿå‘½å‘¨æœŸçš„ DeFi é¡¹ç›®æ™ºèƒ½åˆçº¦ã€‚å»ºè®®ä¸‹ä¸€ä¸ªé¡¹ç›®å°è¯•æ¥å…¥ **ERC20 Token æ¥å£ + å®é™… Token äº¤äº’**ï¼Œå®Œæˆå®Œæ•´çš„é¢†å–ä¸è½¬è´¦ã€‚

