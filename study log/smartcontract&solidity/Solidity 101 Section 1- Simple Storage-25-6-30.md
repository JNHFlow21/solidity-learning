web3 study log 

2025-6-30

ä»Šå¤©è·Ÿç€Patrick Collinså­¦ä¹ äº†[Solidity 101 Section 1: Simple Storage](https://github.com/Cyfrin/foundry-full-course-cu#solidity-101-section-1-simple-storage)ï¼Œåœ¨Sepolia Testnetä¸Šéƒ¨ç½²äº†æˆ‘çš„ç¬¬ä¸€ä¸ªåˆçº¦ï¼Œæ„Ÿè§‰éå¸¸ä¸é”™ï¼Œå­¦ä¹ çš„æ­£åé¦ˆå¾ˆå¥½ã€‚

è¿™èŠ‚è¯¾å†…å®¹ä¸éš¾ï¼Œå°±æ˜¯è®²è§£çš„ä¸€äº›solidityçš„åŸºç¡€å†…å®¹ï¼Œé‡ç‚¹æ˜¯å¤šå†™äº›ä»£ç ã€‚å¯¹äºè¿™ç§çœ‹è§†é¢‘éƒ½ä¼šçš„å†…å®¹ï¼Œæˆ‘çš„å­¦ä¹ æ–¹æ³•æ˜¯åœ¨è§†é¢‘å¯¹åº”çš„githubä»“åº“ä¸­æ‰¾åˆ°å¯¹åº”çš„çŸ¥è¯†ç‚¹ï¼Œç„¶åæˆªå›¾ç»™chatgptè®©ä»–ç»™æˆ‘å‡ºç»ƒä¹ é¢˜ï¼Œç„¶åå†™äº†ä»£ç å†ç»™ä»–çœ‹ï¼Œå¯¹äºä»»ä½•ä¸æ‡‚çš„é—®é¢˜å°±é—®ã€‚å¼„å®Œäº†å°±è®©gptæ ¹æ®é—®ç­”ç”Ÿæˆä¸€ä»½å­¦ä¹ ç¬”è®°å°±OKäº†ï¼Œéå¸¸çš„æ–¹ä¾¿ã€‚

å‡†å¤‡æŠŠæˆ‘çš„å­¦ä¹ ä»£ç ï¼Œä¸€äº›åšçš„ç»ƒä¹ éƒ½ä¼ åˆ°githubä¸Šï¼Œä»¥å‰å­¦ä¹ å…¶ä»–ä¸œè¥¿çš„æ—¶å€™éƒ½æ˜¯æ‡’å¾—å¼„ï¼Œæ„Ÿè§‰è¿˜æ˜¯è¦å¼„ä¸€ä¸‹ï¼Œä»¥åæ‰¾å·¥ä½œä¼šéœ€è¦ã€‚æ˜å¤©ç»§ç»­å­¦ä¹ ï¼Œéå¸¸çš„å¼€å¿ƒï¼Œå¥½ä¹…æ²¡æœ‰è¿™ä¹ˆå……å®çš„å­¦ä¹ è¿‡äº†ï¼Œå¸Œæœ›èƒ½åšæŒä¸‹å»ï¼LFGğŸ”¥ğŸ”¥ğŸ”¥ï¼

## **ä¸€ã€è´¦æˆ·ä¸åˆçº¦åŸºæœ¬åŸç†**

### **1. åŒºå—é“¾è´¦æˆ·ç±»å‹**

- **EOAï¼ˆExternally Owned Accountï¼‰**ï¼šç”±ç”¨æˆ·ç§é’¥æ§åˆ¶çš„é’±åŒ…è´¦æˆ·ã€‚
- **åˆçº¦è´¦æˆ·ï¼ˆContract Accountï¼‰**ï¼šç”±åˆçº¦ä»£ç æ§åˆ¶ï¼Œéƒ¨ç½²æ—¶åˆ›å»ºã€‚

### **2. åˆçº¦éƒ¨ç½²ä¸äº¤æ˜“è¿‡ç¨‹**

- éƒ¨ç½²åˆçº¦å®é™…ä¸Šæ˜¯å‘åŒºå—é“¾å‘é€ä¸€ç¬”ç‰¹æ®Šäº¤æ˜“ï¼Œto ä¸º nullï¼Œinput æ˜¯åˆçº¦çš„å­—èŠ‚ç ã€‚
- åˆçº¦éƒ¨ç½²æˆåŠŸåä¼šæœ‰ä¸€ä¸ªç”Ÿæˆçš„ contract addressã€‚
- å‘åˆçº¦å‘èµ·äº¤äº’ï¼ˆå¦‚è°ƒç”¨å‡½æ•°ï¼‰ä¸å‘æ™®é€šåœ°å€è½¬è´¦ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äº input data åŒ…å«å‡½æ•°ç­¾åä¸å‚æ•°ç¼–ç ã€‚

## **äºŒã€Solidity åˆçº¦åŸºç¡€è¯­æ³•**

### **1. çŠ¶æ€å˜é‡ä¸å‡½æ•°**

- è¯­æ³•æ ¼å¼ï¼štype visibility nameï¼Œä¾‹å¦‚ uint public count;
- å‡½æ•°å®šä¹‰é¡ºåºä¸èƒ½é¢ å€’ï¼šfunction name(...) visibility view/pure returns (...)
- public ä¿®é¥°å˜é‡ä¼šè‡ªåŠ¨ç”Ÿæˆ getter å‡½æ•°ã€‚

### **2. å‡½æ•°ä¿®é¥°ç¬¦**

- viewï¼šå¯è¯»å–çŠ¶æ€å˜é‡ï¼Œä¸èƒ½ä¿®æ”¹ã€‚
- pureï¼šä¸èƒ½è¯»å–æˆ–ä¿®æ”¹çŠ¶æ€å˜é‡ï¼ˆä½†å¯ä»¥ä½¿ç”¨ msg.senderã€tx.origin ç­‰å…¨å±€å˜é‡ï¼‰ã€‚
- externalï¼šåªèƒ½è¢«åˆçº¦å¤–éƒ¨è°ƒç”¨ã€‚
- internalï¼šåªèƒ½è¢«å½“å‰åˆçº¦æˆ–ç»§æ‰¿è€…å†…éƒ¨è°ƒç”¨ã€‚
- privateï¼šåªèƒ½åœ¨å½“å‰åˆçº¦å†…éƒ¨è°ƒç”¨ã€‚

## **ä¸‰ã€æ•°æ®ä½ç½®å…³é”®å­—**

### **1. æ•°æ®ä½ç½®ç±»å‹**

| **å…³é”®å­—** | **è¯´æ˜**                   |
| ---------- | -------------------------- |
| storage    | æ°¸ä¹…å‚¨å­˜åœ¨é“¾ä¸Šï¼ˆé»˜è®¤ä½ç½®ï¼‰ |
| memory     | å‡½æ•°æ‰§è¡ŒæœŸé—´çš„ä¸´æ—¶å†…å­˜     |
| calldata   | å¤–éƒ¨å‡½æ•°å‚æ•°çš„åªè¯»æ•°æ®åŒº   |

### **2. ä½¿ç”¨åœºæ™¯**

- stringã€bytesã€æ•°ç»„ã€ç»“æ„ä½“ç­‰å¼•ç”¨ç±»å‹ï¼Œå¿…é¡»åœ¨å‡½æ•°å‚æ•°ä¸­æŒ‡æ˜æ•°æ®ä½ç½®ã€‚
- å¤–éƒ¨å‡½æ•°å‚æ•°ä½¿ç”¨ calldata æ›´èŠ‚çœ gasï¼Œå†…éƒ¨å‡½æ•°å‚æ•°æˆ–å¤„ç†éœ€è¦ä¿®æ”¹æ—¶ç”¨ memoryã€‚
- storage ç”¨äºè®¿é—®å’Œä¿®æ”¹çŠ¶æ€å˜é‡ã€‚

## **å››ã€bytes vs string**

### **1. å¯¹æ¯”**

| **ç±»å‹** | **ç‰¹ç‚¹**                   |
| -------- | -------------------------- |
| string   | åŠ¨æ€é•¿åº¦ï¼ŒUTF-8 å­—ç¬¦ä¸²     |
| bytes32  | å›ºå®šé•¿åº¦ 32 å­—èŠ‚ï¼Œæˆªæ–­æº¢å‡º |
| bytes    | å¯å˜é•¿åº¦åŸå§‹å­—èŠ‚æ•°ç»„       |

### **2. Gas æ¶ˆè€—å¯¹æ¯”**

- string s = "hello"ï¼šå˜é•¿ï¼Œgas æ¶ˆè€—é«˜ã€‚
- bytes32 b = "hello"ï¼šå›ºå®šé•¿ï¼Œåªå–å‰ 32 å­—èŠ‚ï¼Œgas æ›´å°‘ã€‚

## **äº”ã€è¾“å…¥æ•°æ®ä¸ ABI ç¼–ç **

### **1. input/output è§£ç **

- input æ˜¯ ABI ç¼–ç çš„å‡½æ•°ç­¾åå’Œå‚æ•°ã€‚
- output æ˜¯ ABI ç¼–ç çš„è¿”å›å€¼ã€‚
- å¯ä½¿ç”¨ Remixã€Etherscan ç­‰å·¥å…·æŸ¥çœ‹ decoded input/outputã€‚

### **2. ç¤ºä¾‹**

```
function store(uint _value) public {
    favoriteNumber = _value;
}
```

è°ƒç”¨æ—¶ input ä¸ºï¼š0x6057361d...ï¼ˆå‡½æ•°é€‰æ‹©å™¨+å‚æ•°ç¼–ç ï¼‰

## **å…­ã€æ•°ç»„ä¸ç»“æ„ä½“**

### **1. æ•°ç»„**

- å›ºå®šæ•°ç»„ï¼šuint[3] nums;
- åŠ¨æ€æ•°ç»„ï¼šuint[] nums;ï¼Œå¯ç”¨ push æ·»åŠ å…ƒç´ 

### **2. Structï¼ˆç»“æ„ä½“ï¼‰**

```
struct Person {
    string name;
    uint age;
}
Person[] public people;
```

## **ä¸ƒã€æ˜ å°„ï¼ˆmappingï¼‰**

### **1. åŸºæœ¬ç”¨æ³•**

```
mapping(address => bool) public hasVoted;
```

### **2. ç‰¹ç‚¹**

- ç±»ä¼¼å“ˆå¸Œè¡¨ï¼Œé»˜è®¤å€¼ä¸ºé›¶å€¼ï¼ˆå¦‚ falseï¼‰ã€‚
- ä¸å¯éå†ï¼Œä¸æ”¯æŒ length æˆ– keysã€‚

## **å…«ã€Gas æ¶ˆè€—ä¸äº¤æ˜“æ˜ç»†åˆ†æ**

### **1. Gas å«ä¹‰**

- **Gas Limit**ï¼šæœ€å¤§å…è®¸æ¶ˆè€—é‡ã€‚
- **Gas Used**ï¼šå®é™…æ¶ˆè€—ã€‚
- **Transaction Fee** = Gas Used Ã— Gas Priceã€‚
- **Base Fee**ï¼šEIP-1559 åçš„æœ€ä½ gas è´¹ã€‚
- **Priority Feeï¼ˆå°è´¹ï¼‰**ï¼šç”¨æˆ·é¢å¤–ä»˜ç»™çŸ¿å·¥çš„è´¹ç”¨ã€‚
- **Burnt**ï¼šé”€æ¯çš„ base feeã€‚

### **2. ç¤ºä¾‹åˆ†æ**

```
Gas Limit: 266,567
Gas Used: 263,310
Base Fee: 0.008796225 Gwei
Priority Fee: 1.5 Gwei
æ€»è´¹ç”¨ = Gas Used Ã— (Base + Priority)
```

## **ä¹ã€ç»ƒä¹ é¢˜æˆæœæ±‡æ€»**

- PeopleListï¼šä½¿ç”¨ struct + array
- Calculatorï¼šçº¯å‡½æ•° add() ä¸è§†å›¾å‡½æ•° getOwner()
- RoleCheckï¼šä½¿ç”¨ private å‡½æ•°å°è£…é€»è¾‘
- DataHandlerï¼šä½¿ç”¨ memory ä¸ calldata çš„å¯¹æ¯”
- VoteBoxï¼šä½¿ç”¨ mapping å®ç°é˜²æ­¢é‡å¤æŠ•ç¥¨

